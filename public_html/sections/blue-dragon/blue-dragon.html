<div class="widget">
	<h2>The Colorado River basin is an interconnected system of rivers, reservoirs, and diversions.</h2>
	<div id="blueDragon">
		
		<object id="bluedragon-object" data="img/bluedragon.svg" type="image/svg+xml" onload="window.owdiDrought.blueDragonScene.createBDScene()"></object>
	</div>
	<div class="SVGInfo" id="hoover">
		<p>Hoover Dam</p>
	</div>
	<div class="SVGInfo" id="davis">
		<p>Davis Dam</p>
	</div>
	<div class="SVGInfo" id="parker">
		<p>Parker Dam</p>
	</div>
	<div class="SVGInfo" id="imperial">
		<p>Imperial Dam</p>
	</div>

	<div class="sectionContent">
		<a href="http://txpub.usgs.gov/DSS/StoryMaps/BlueDragon/" target="_blank"><div id="texas-thumbnail">
			<img src="{{baseUrl}}/img/texas-app.png" alt="texas water science center app"/>
		</div></a>
		<p class="explore-more"><a href="http://txpub.usgs.gov/DSS/StoryMaps/BlueDragon/" target="_blank"><img class="leaving" src="{{baseUrl}}/img/leavingapp-icon.png" alt="leaving application icon"/>Click here</a> to explore the lower Colorado control structures and major diversions.</p>
	</div>
        
<script type="text/javascript">
/* global owdiDrought */
/* global ScrollMagic */
/* global $ */
/* global console */
(function() {
	"use strict";
	owdiDrought.blueDragonScene = {};
	owdiDrought.blueDragonScene.createBDScene = function() {
		if (!owdiDrought.blueDragonScene.blueDragonSVG) {
			owdiDrought.blueDragonScene.blueDragonSVG = document.getElementById("bluedragon-object").getSVGDocument();
		}
	};
	owdiDrought.blueDragonScene.triggers = {
		hoover: false,
		davis: false,
		parker: false,
		imperial: false
	};
	
	var parentContainer = "#blueDragon",
		defaultTransitionSpeed = 'slow',
		defaultEndFunction = function(e) {
			var $section = $("#" + e.target.name);

			if (e.scrollDirection.toUpperCase() === "FORWARD") {
				$section.fadeOut(defaultTransitionSpeed);
			} else {
				$section.fadeIn(defaultTransitionSpeed);
			}
		};
	
	var setScene = function() {
		var defaultDuration = 300,
			fadeSpeed = defaultTransitionSpeed,
			forward = "FORWARD",
			// Define the actions. Each action may have a start and an end as well as a duraiton
			actions = {
				// Each action's name needs to match the ID of the div it's acting on. The name is used as
				// a selector within each function
				"hoover": {
					"start": function(e) {
						var $section = $("#" + e.target.name);
						if (!owdiDrought.blueDragonScene.triggers.hoover) {
							$section.fadeIn(fadeSpeed, owdiDrought.blueDragonScene.blueDragonSVG.meadDavisAnimate);
							owdiDrought.blueDragonScene.triggers.hoover = true;
						}
					}
				},
				"davis": {
					"offset": 300,
					"start": function(e) {
						var $section = $("#" + e.target.name);
						if (owdiDrought.blueDragonScene.triggers.hoover &&
								!owdiDrought.blueDragonScene.triggers.davis) {
							$section.fadeIn(fadeSpeed, owdiDrought.blueDragonScene.blueDragonSVG.davisParkerAnimate);
							owdiDrought.blueDragonScene.triggers.davis = true;
						}
					}
				},
				"parker": {
					"offset": 600,
					"start": function(e) {
						var $section = $("#" + e.target.name);
						if (owdiDrought.blueDragonScene.triggers.davis &&
								!owdiDrought.blueDragonScene.triggers.parker) {
							$section.fadeIn(fadeSpeed, owdiDrought.blueDragonScene.blueDragonSVG.parkerImperialAnimate);
							owdiDrought.blueDragonScene.triggers.parker = true;
						}
					}
				},
				"imperial": {
					"offset": 900,
					"start": function(e) {
						var $section = $("#" + e.target.name);
						if (owdiDrought.blueDragonScene.triggers.parker &&
								!owdiDrought.blueDragonScene.triggers.imperial) {
							$section.fadeIn(fadeSpeed, owdiDrought.blueDragonScene.blueDragonSVG.imperialMorelosAnimate);
							owdiDrought.blueDragonScene.triggers.imperial = true;
						}
					}
				},
			};
			
		for (var action in actions) {
			if (actions.hasOwnProperty(action)) {
				var scene = actions[action];
				scene.parentContainer = parentContainer;
				scene.duration = defaultDuration;
				scene.name = action;
				scene.pin = parentContainer;

				if (!scene.triggerHook) {
					scene.triggerHook = "onLeave";
				}

				// All of the scenes seem to have the same end function so I just want
				// to declare that once. If you want to diverge from the generic end function,
				// just add an 'end' function to the scene in the actions object
				if (!scene.end) {
					scene.end = defaultEndFunction;
				}

				window.owdiDrought.addScene(scene, action);
			}
		}
	};
	
	setScene();
})();
</script>
