<div class="widget">
    <div id="meadSVGContainer">
        <h2>Mead SVG Dealio</h2>
        <object id="mead-object" data="img/lo_CO_borders.svg" type="image/svg+xml" onload="window.owdiDrought.create()"></object>
    </div>
    <div class="SVGInfo" id="info1">
        <p>Suspendisse fermentum convallis porttitor. Interdum et malesuada fames ac ante ipsum primis in faucibus. Proin condimentum dictum justo a dapibus. Praesent nec libero nec ipsum ultricies posuere. Duis in pretium est. Etiam gravida pulvinar tellus vitae finibus</p>
    </div>
    <div class="SVGInfo" id="info2">
        <p>Nunc cursus et diam quis eleifend. Cras venenatis velit quis mattis pulvinar. Cras hendrerit id erat at consequat. Aenean quis interdum leo. Nullam eget massa ultrices magna condimentum interdum.</p>
    </div>
    <div class="SVGInfo" id="info3">
        <p>Fixie Austin YOLO, health goth American Apparel raw denim Thundercats occupy Williamsburg Pitchfork listicle. Sunt narwhal Wes Anderson, pickled Bushwick put a bird on it cred. Ad shabby chic eu, labore enim plaid kitsch craft beer aliquip mixtape nesciunt pop-up proident cornhole. </p>
    </div>
    <div class="SVGInfo" id="info4">
        <p>Bacon ipsum dolor amet rump short loin ribeye chuck picanha shank meatball, shankle alcatra ground round. Kielbasa landjaeger turkey, pork loin tri-tip pork belly picanha turducken hamburger frankfurter beef ribs ribeye flank.</p>
    </div>
</div>
<script>
/* global owdiDrought */
/* global ScrollMagic */
/* global $ */
/* global console */

(function() {
    "use strict";
    owdiDrought.meadObjectSVG = null;

    owdiDrought.create = function() {
        var meadObjectDomElement = document.getElementById("mead-object"),
            getMeadObject = function() {
                if (owdiDrought.meadObjectSVG === null) {
                    owdiDrought.meadObjectSVG = meadObjectDomElement.getSVGDocument();
                    
                }
            }

        new ScrollMagic.Scene({
                triggerElement: svgContainer,
                duration: 100
            })
            .on("enter", function() {
                getMeadObject();
            })
            .addTo(window.owdiDrought.SMController);

    };
    
    var svgContainer = "#meadSVGContainer",
        parentContainer = "#container16",
        defaultDuration = 300,
        addTriggerFunction = function(item) {
            var scene = new ScrollMagic.Scene({
                    triggerElement: parentContainer,
                    duration: defaultDuration
                })
				.triggerHook(0)
                .offset(item.offset)
                .setPin(parentContainer)
                .addTo(window.owdiDrought.SMController)
                .addIndicators();

            if (item.start) {
                scene.on("start", item.start);
            }
            if (item.end) {
                scene.on("end", item.end);
            }
        },
        fadeSpeed = "slow",
        // Define the actions 
        actions = {
            // Each action has a name but the name is currently not used for anything except 
            // a label to easily identify what the actions within do
            drawRiver: {
                "start": function(e) {
                    var $section = $("#info1");
                    if (e.scrollDirection.toUpperCase() === "FORWARD") {
                        $section.fadeIn(fadeSpeed, owdiDrought.meadObjectSVG.drawRiver());
                    } else {
                        $section.fadeOut(fadeSpeed, owdiDrought.meadObjectSVG.resetRiver());
                    }
                },
                "end": function(e) {
                    var $section = $("#info1");
                    if (e.scrollDirection.toUpperCase() === "FORWARD") {
                        $section.fadeOut(fadeSpeed);
                    } else {
                        $section.fadeIn(fadeSpeed);
                    }
                }
            },
            drawBasin: {
                "offset": 300,
                "start": function(e) {
					var $section = $("#info2");
                    if (e.scrollDirection.toUpperCase() === "FORWARD") {
                        $section.fadeIn(fadeSpeed, owdiDrought.meadObjectSVG.drawBasin());
                    } else {
                        $section.fadeOut(fadeSpeed, owdiDrought.meadObjectSVG.resetBasin());
                    }
                },
                "end": function(e) {
                    var $section = $("#info2");
                    if (e.scrollDirection === "FORWARD") {
                        $section.fadeOut(fadeSpeed);
                    } else {
                        $section.fadeIn(fadeSpeed);
                    }
                }
            },
            drawPictogram: {
                "offset": 600,
                "start": function(e) {
					var $section = $("#info3");
                    if (e.scrollDirection.toUpperCase() === "FORWARD") {
                        $section.fadeIn(fadeSpeed, owdiDrought.meadObjectSVG.drawPictogram());
                    } else {
                        $section.fadeOut(fadeSpeed, owdiDrought.meadObjectSVG.removePictogram());
                    }
                },
				"end": function(e) {
                    var $section = $("#info3");
                    if (e.scrollDirection === "FORWARD") {
                        $section.fadeOut(fadeSpeed);
                    } else {
                        $section.fadeIn(fadeSpeed);
                    }
                }
            },
            highlightUser1: {
                "offset": 900,
                "start": function(e) {
					var $section = $('#info4');
                    if (e.scrollDirection.toUpperCase() === "FORWARD") {
                        $section.fadeIn(fadeSpeed, owdiDrought.meadObjectSVG.highlightUser(1));
                    }else{
						$section.fadeOut(fadeSpeed);
						}
                },
				"end":function(e) {
					var $section = $('#info4');
					if (e.scrollDirection.toUpperCase() === "FORWARD") {
						$section.fadeOut(fadeSpeed);
					}else {
						$section.fadeIn(fadeSpeed);
						}
					}
            },
            highlightUser2: {
                "offset": 1200,
                "start": function(e) {
                    if (e.scrollDirection.toUpperCase() === "FORWARD") {
                        owdiDrought.meadObjectSVG.highlightUser(2);
                    }
                }
            },
            highlightUser3: {
                "offset": 1500,
                "start": function(e) {
                    if (e.scrollDirection.toUpperCase() === "FORWARD") {
                        owdiDrought.meadObjectSVG.highlightUser(3);
                    }
                }
            },
            highlightUser4: {
                "offset": 1800,
                "start": function(e) {
                    if (e.scrollDirection.toUpperCase() === "FORWARD") {
                        owdiDrought.meadObjectSVG.highlightUser(4);
                    }
                }
            },
            highlightUser5: {
                "offset": 2100,
                "start": function(e) {
                    if (e.scrollDirection.toUpperCase() === "FORWARD") {
                        owdiDrought.meadObjectSVG.highlightUser(5);
                    }
                }
            },
            removeItems: {
                "offset": 2400,
                "start": function(e) {
                    if (e.scrollDirection.toUpperCase() === "FORWARD") {
                        owdiDrought.meadObjectSVG.removeGreyStates();
                        owdiDrought.meadObjectSVG.removeRiver();
                        owdiDrought.meadObjectSVG.removePictogram();
                    } else {
                        owdiDrought.meadObjectSVG.resetGreyStates();
                        owdiDrought.meadObjectSVG.drawPictogram();
                        owdiDrought.meadObjectSVG.drawBasin();
                        owdiDrought.meadObjectSVG.showRiver();
                    }
                }
            },
            moveStates: {
                "offset": 2700,
                "start": function(e) {
                    if (e.scrollDirection.toUpperCase() === "FORWARD") {
                        owdiDrought.meadObjectSVG.moveStates();
                        owdiDrought.meadObjectSVG.drawMead();
                    } else {
                        owdiDrought.meadObjectSVG.resetStates();
                        owdiDrought.meadObjectSVG.removeMead();
                    }
                }
            }
        };

    // For every action I have, set the ScrollMagic event triggering for it
    for (var action in actions) {
        if (actions.hasOwnProperty(action)) {
            addTriggerFunction(actions[action]);
            console.trace("Set ScrollMagic action in section 16 for action " + action);
        }
    }


})();
</script>
